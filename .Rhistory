cbind(., simsRL_LTMpipe$data$set6_test) %>%
rep(., 12) %>%
as.matrix() %>%
reshape(., nrow(simsRL_LTMpipe$data) * 12, 2) %>%
reshape(., nrow(simsRL_LTMpipe$data) *2, 12)
RL_LTMpipe.sim.dat <- cbind(simsRL_LTMpipe.set3learn,
simsRL_LTMpipe.set6learn,
simsRL_LTMpipe.s3s6test.temp[1:nrow(simsRL_LTMpipe$data), ],
simsRL_LTMpipe.s3s6test.temp[244 : 486 ],
simsRL_LTMpipe$data[,c('bll','alpha','egs','imag','ans')]) %>% data.table()
#--------- Integrated model assigned strategy
simsRL_LTMstr <- fromJSON('./outdated_sim_data/RLLTM1_strategy_sim_data050420.JSON')
simsRL_LTMstr.set3learn <- simsRL_LTMstr$data$set3_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL_LTMstr$data)) %>%
t()
simsRL_LTMstr.set6learn <- simsRL_LTMstr$data$set6_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL_LTMstr$data)) %>%
t()
simsRL_LTMstr.s3s6test.temp <-
simsRL_LTMstr$data$set3_test %>%
cbind(., simsRL_LTMstr$data$set6_test) %>%
rep(., 12) %>%
as.matrix() %>%
reshape(., nrow(simsRL_LTMstr$data) * 12, 2) %>%
reshape(., nrow(simsRL_LTMstr$data) *2, 12)
RL_LTMstr.sim.dat <- cbind(simsRL_LTMstr.set3learn,
simsRL_LTMstr.set6learn,
simsRL_LTMstr.s3s6test.temp[1:nrow(simsRL_LTMstr$data), ],
simsRL_LTMstr.s3s6test.temp[973 : 1944 ],
simsRL_LTMstr$data[,c('bll','alpha','egs','imag','ans')]) %>%
data.table()
#--------- Reinforcement Learning Model
simsRL <- fromJSON('./outdated_sim_data/RL_sim_data_3lvsparams_050420.JSON')
simsRL.set3learn <- simsRL$data$set3_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL$data)) %>%
t()
simsRL.set6learn <- simsRL$data$set6_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL$data)) %>%
t()
simsRL.s3s6test.temp <-
simsRL$data$set3_test %>%
cbind(., simsRL$data$set6_test) %>%
rep(., 12) %>%
as.matrix() %>%
reshape(., nrow(simsRL$data)*12, 2) %>%
reshape(., nrow(simsRL$data)*2, 12)
RL.sim.dat <- cbind(simsRL.set3learn,
simsRL.set6learn,
simsRL.s3s6test.temp[1:nrow(simsRL$data), ],
simsRL.s3s6test.temp[10:18, ] ,
simsRL$data[,c('bll','alpha','egs','imag','ans')]) %>%
data.table()
#--------- Longterm Memory/WM/Declarative model
simsLTM    <- fromJSON('LTM_visual_activation_allparams_evals26.JSON')#('LTM_sim_data_3lvparams_050420.JSON')
simsLTM.set3learn <- simsLTM$data$set3_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsLTM$data)) %>%
t()
simsLTM.set6learn <- simsLTM$data$set6_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsLTM$data)) %>%
t()
simsLTM.s3s6test.temp <-  simsLTM$data$set3_test %>%
cbind(., simsLTM$data$set6_test) %>%
rep(., 12) %>%
as.matrix() %>%
reshape(., 324, 2) %>%
reshape(., 54, 12) #54= nrow(sims.LTM) * 2
LTM.sim.dat <- cbind(simsLTM.set3learn,
simsLTM.set6learn,
simsLTM.s3s6test.temp[1:27, ],
simsLTM.s3s6test.temp[28:54, ],
simsLTM$data[,c('bll','alpha','egs','imag','ans')]) %>%
data.table()
# LTM.sim.dat <- cbind('set3_learn'=simsLTM.set3learn %>% c(),
#                    'set6_learn'=simsLTM.set6learn %>% c(),
#                   'time'=rep(1:12,324/12),
#                  'set3_test'=simsLTM.s3s6test.temp[1:27, ] %>% c(),
#                 'set6_test'=simsLTM.s3s6test.temp[28:54, ] %>% c(),
#                simsLTM$data[,c('bll','alpha','egs','imag','ans')]) %>%
#data.table()
#------Descriptive measures: learning rate (beta), accuracy learn & Test, differences between learn3 and learn 6
#--------select data for each level of parameters per model
RL.params        <- param.influence(RL.sim.dat, 'RL')
RLLTMpipe.params <- param.influence(RL_LTMpipe.sim.dat, 'RLLTM')
RLLTMstr.params  <- param.influence(RL_LTMstr.sim.dat, 'RLLTM')
LTM.params       <- param.influence(LTM.sim.dat, 'LTM')
tmp.color = c('#ca0020','#f4a582' ,'#0571b0','#92c5de')
grid.arrange(
RL.params %>%
melt(value.name = 'accuracy',id.vars=c('parameter','level')) %>%
ggplot(aes(level, accuracy, color=variable)) +
geom_point()+
geom_line() +
facet_grid('parameter')+
theme_bw(base_size = 16, base_line_size = 1)+
scale_color_manual(values = tmp.color),
#scale_colour_brewer( palette = "RdBu", direction = 1)
LTM.params %>%
melt(value.name = 'accuracy',id.vars=c('parameter','level')) %>%
ggplot(aes(level, accuracy, color=variable)) +
geom_point()+
geom_line() +
facet_grid('parameter')+
theme_bw(base_size = 16, base_line_size = 1)+
scale_color_manual(values = tmp.color),
RLLTMpipe.params %>%
melt(value.name = 'accuracy',id.vars=c('parameter','level')) %>%
ggplot(aes(level, accuracy, color=variable)) +
geom_point()+
geom_line() +
facet_grid('parameter')+
theme_bw(base_size = 16, base_line_size = 1)+
scale_color_manual(values = tmp.color),
RLLTMstr.params %>%
melt(value.name = 'accuracy',id.vars=c('parameter','level')) %>%
ggplot(aes(level, accuracy, color=variable)) +
geom_point()+
geom_line() +
facet_grid('parameter')+
theme_bw(base_size = 16, base_line_size = 1)+
scale_color_manual(values = tmp.color),
nrow=1,ncol=4)
RL_LTMorig.sim.dat
sdat
sdat = fread('./RLWM_data/all_subject_n83_learn_test_data.csv', header = T) %>% t()
#------ Modify subject data to 'weight' accuracy in test for 3 and 6 by repeating each 12x
sdat.temp <- rep(sdat[ , 25:26], 12) %>%
as.matrix() %>%
reshape(., 996,2) %>%
reshape(., 166,12)
setwd('~/RLWM_ACTR/')
sdat = fread('./RLWM_data/all_subject_n83_learn_test_data.csv', header = T) %>% t()
#------ Modify subject data to 'weight' accuracy in test for 3 and 6 by repeating each 12x
sdat.temp <- rep(sdat[ , 25:26], 12) %>%
as.matrix() %>%
reshape(., 996,2) %>%
reshape(., 166,12)
sdat.mod  <- cbind(sdat[, 1:24],
sdat.temp[1:83,],
sdat.temp[84:166, ])
#----- import model data (has to be converted from JSON to data frames)
#--------- Integrated model original
simsRL_LTMorig <- fromJSON('./outdated_sim_data/RLLTMorig_sim_data050520.JSON')
simsRL_LTMorig.set3learn <- simsRL_LTMorig$data$set3_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL_LTMorig$data)) %>%
t()
simsRL_LTMorig.set6learn <- simsRL_LTMorig$data$set6_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL_LTMorig$data)) %>%
t()
simsRL_LTMorig.s3s6test.temp <-
simsRL_LTMorig$data$set3_test %>%
cbind(., simsRL_LTMorig$data$set6_test) %>%
rep(., 12) %>%
as.matrix() %>%
reshape(., nrow(simsRL_LTMorig$data)*12, 2) %>%
reshape(., nrow(simsRL_LTMorig$data)*2, 12)
RL_LTMorig.sim.dat <- cbind(simsRL_LTMorig.set3learn,
simsRL_LTMorig.set6learn,
simsRL_LTMorig.s3s6test.temp[1:nrow(simsRL_LTMorig$data), ],
simsRL_LTMorig.s3s6test.temp[244:486, ],
simsRL_LTMorig$data[,c('bll','alpha','egs','imag','ans')])
RL_LTMorig.sim.dat
RL_LTMorig.sim.dat %>% ncol()
#--------- Integrated model RL to LTM pipe
simsRL_LTMpipe <- fromJSON('./outdated_sim_data/RLLTM2_pipe_sim_data050420.JSON')
simsRL_LTMpipe.set3learn <- simsRL_LTMpipe$data$set3_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL_LTMpipe$data)) %>%
t()
simsRL_LTMpipe.set6learn <- simsRL_LTMpipe$data$set6_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL_LTMpipe$data)) %>%
t()
simsRL_LTMpipe.s3s6test.temp <-
simsRL_LTMpipe$data$set3_test %>%
cbind(., simsRL_LTMpipe$data$set6_test) %>%
rep(., 12) %>%
as.matrix() %>%
reshape(., nrow(simsRL_LTMpipe$data) * 12, 2) %>%
reshape(., nrow(simsRL_LTMpipe$data) *2, 12)
RL_LTMpipe.sim.dat <- cbind(simsRL_LTMpipe.set3learn,
simsRL_LTMpipe.set6learn,
simsRL_LTMpipe.s3s6test.temp[1:nrow(simsRL_LTMpipe$data), ],
simsRL_LTMpipe.s3s6test.temp[244 : 486 ],
simsRL_LTMpipe$data[,c('bll','alpha','egs','imag','ans')]) %>% data.table()
RL_LTMpipe.sim.dat %>% ncol()
RL_LTMpipe.sim.dat <- cbind(simsRL_LTMpipe.set3learn,
simsRL_LTMpipe.set6learn,
simsRL_LTMpipe.s3s6test.temp[1:nrow(simsRL_LTMpipe$data), ],
simsRL_LTMpipe.s3s6test.temp[244 : 486 ],
simsRL_LTMpipe$data[,c('bll','alpha','egs','imag','ans')])
RL_LTMpipe.sim.dat %>% ncol()
simsRL_LTMorig$data$strtg
#--------- Integrated model RL to LTM pipe
simsRL_LTMpipe <- fromJSON('./outdated_sim_data/RLLTM2_pipe_sim_data050420.JSON')
simsRL_LTMpipe$data$set3_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL_LTMpipe$data)) %>%
t()
simsRL_LTMpipe.set3learn <- simsRL_LTMpipe$data$set3_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL_LTMpipe$data)) %>%
t()
simsRL_LTMpipe.set6learn <- simsRL_LTMpipe$data$set6_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL_LTMpipe$data)) %>%
t()
simsRL_LTMpipe$data$set3_test %>%
cbind(., simsRL_LTMpipe$data$set6_test)
nrow(simsRL_LTMpipe$data)
nrow(simsRL_LTMpipe$data)*12
simsRL_LTMpipe$data$set3_test %>%
cbind(., simsRL_LTMpipe$data$set6_test) %>%
rep(., 12) %>%
as.matrix() %>%
reshape(., nrow(simsRL_LTMpipe$data) * 12, 2)
simsRL_LTMpipe.s3s6test.temp <-
simsRL_LTMpipe$data$set3_test %>%
cbind(., simsRL_LTMpipe$data$set6_test) %>%
rep(., 12) %>%
as.matrix() %>%
reshape(., nrow(simsRL_LTMpipe$data) * 12, 2) %>%
reshape(., nrow(simsRL_LTMpipe$data) *2, 12)
View(simsRL_LTMpipe.s3s6test.temp)
486/2
cbind(simsRL_LTMpipe.set3learn,
simsRL_LTMpipe.set6learn,
simsRL_LTMpipe.s3s6test.temp[1:nrow(simsRL_LTMpipe$data), ],
simsRL_LTMpipe.s3s6test.temp[244 : 486 ]) %>% View()
37+5
12*4
cbind( simsRL_LTMpipe.s3s6test.temp[1:nrow(simsRL_LTMpipe$data), ],
simsRL_LTMpipe.s3s6test.temp[244 : 486 ]) %>% View()
RL_LTMpipe.sim.dat <- cbind(simsRL_LTMpipe.set3learn,
simsRL_LTMpipe.set6learn,
simsRL_LTMpipe.s3s6test.temp[1:nrow(simsRL_LTMpipe$data), ],
simsRL_LTMpipe.s3s6test.temp[244 : 486, ],
simsRL_LTMpipe$data[,c('bll','alpha','egs','imag','ans')]) %>%
data.table()
#--------- Integrated model assigned strategy
simsRL_LTMstr <- fromJSON('./outdated_sim_data/RLLTM1_strategy_sim_data050420.JSON')
simsRL_LTMstr.set3learn <- simsRL_LTMstr$data$set3_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL_LTMstr$data)) %>%
t()
simsRL_LTMstr.set6learn <- simsRL_LTMstr$data$set6_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL_LTMstr$data)) %>%
t()
simsRL_LTMstr.s3s6test.temp <-
simsRL_LTMstr$data$set3_test %>%
cbind(., simsRL_LTMstr$data$set6_test) %>%
rep(., 12) %>%
as.matrix() %>%
reshape(., nrow(simsRL_LTMstr$data) * 12, 2) %>%
reshape(., nrow(simsRL_LTMstr$data) *2, 12)
RL_LTMstr.sim.dat <- cbind(simsRL_LTMstr.set3learn,
simsRL_LTMstr.set6learn,
simsRL_LTMstr.s3s6test.temp[1:nrow(simsRL_LTMstr$data), ],
simsRL_LTMstr.s3s6test.temp[973 : 1944, ],
simsRL_LTMstr$data[,c('bll','alpha','egs','imag','ans')]) %>%
data.table()
mseRL.temp         =c()
mseLTM.temp        =c()
mseRL_LTMorig.temp =c()
mseRL_LTMpipe.temp =c()
mseRL_LTMstr.temp  =c()
for(s in c(1:nrow(sdat.mod))) { # for each subject
# model 1
mseRL.temp     <- rbind(mseRL.temp, apply(RL.sim.dat[, 1:48], 1, function(x,y) MSE(x, sdat.mod[s, ])))
# model 2
mseLTM.temp    <- rbind(mseLTM.temp, apply(LTM.sim.dat[, 1:48], 1, function(x,y) MSE(x, sdat.mod[s, ] )))
# model 3
mseRL_LTMorig.temp <- rbind(mseRL_LTMorig.temp,
apply(RL_LTMorig.sim.dat[, 1:48], 1, function(x,y) MSE(x, sdat.mod[s, ])))
# model 3.1
mseRL_LTMpipe.temp <- rbind(mseRL_LTMpipe.temp,
apply(RL_LTMpipe.sim.dat[, 1:48], 1, function(x,y) MSE(x, sdat.mod[s, ])))
# model 3.2
mseRL_LTMstr.temp  <- rbind(mseRL_LTMstr.temp,
apply(RL_LTMstr.sim.dat[, 1:48], 1, function(x,y) MSE(x, sdat.mod[s, ])))
}
#----- import subject data
#
sdat = fread('./RLWM_data/all_subject_n83_learn_test_data.csv', header = T) %>% t()
# sdat contains data fro 83 participants (columns),
# rows 1:12 learn accuracy set 3 ;
# rows 13:24 learn accuracy set 6 ;
# row 25 test set 3 accuracy ;
# row 26 test set 6 accuracy ;
#------ Modify subject data to 'weight' accuracy in test for 3 and 6 by repeating each 12x
sdat.temp <- rep(sdat[ , 25:26], 12) %>%
as.matrix() %>%
reshape(., 996,2) %>%
reshape(., 166,12)
sdat.mod  <- cbind(sdat[, 1:24],
sdat.temp[1:83,],
sdat.temp[84:166, ])
#----- import model data (has to be converted from JSON to data frames)
#--------- Integrated model original
simsRL_LTMorig <- fromJSON('./outdated_sim_data/RLLTMorig_sim_data050520.JSON')
simsRL_LTMorig.set3learn <- simsRL_LTMorig$data$set3_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL_LTMorig$data)) %>%
t()
simsRL_LTMorig.set6learn <- simsRL_LTMorig$data$set6_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL_LTMorig$data)) %>%
t()
simsRL_LTMorig.s3s6test.temp <-
simsRL_LTMorig$data$set3_test %>%
cbind(., simsRL_LTMorig$data$set6_test) %>%
rep(., 12) %>%
as.matrix() %>%
reshape(., nrow(simsRL_LTMorig$data)*12, 2) %>%
reshape(., nrow(simsRL_LTMorig$data)*2, 12)
RL_LTMorig.sim.dat <- cbind(simsRL_LTMorig.set3learn,
simsRL_LTMorig.set6learn,
simsRL_LTMorig.s3s6test.temp[1:nrow(simsRL_LTMorig$data), ],
simsRL_LTMorig.s3s6test.temp[244:486, ],
simsRL_LTMorig$data[,c('bll','alpha','egs','imag','ans')])
#--------- Integrated model RL to LTM pipe
simsRL_LTMpipe <- fromJSON('./outdated_sim_data/RLLTM2_pipe_sim_data050420.JSON')
simsRL_LTMpipe.set3learn <- simsRL_LTMpipe$data$set3_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL_LTMpipe$data)) %>%
t()
simsRL_LTMpipe.set6learn <- simsRL_LTMpipe$data$set6_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL_LTMpipe$data)) %>%
t()
simsRL_LTMpipe.s3s6test.temp <-
simsRL_LTMpipe$data$set3_test %>%
cbind(., simsRL_LTMpipe$data$set6_test) %>%
rep(., 12) %>%
as.matrix() %>%
reshape(., nrow(simsRL_LTMpipe$data) * 12, 2) %>%
reshape(., nrow(simsRL_LTMpipe$data) *2, 12)
RL_LTMpipe.sim.dat <- cbind(simsRL_LTMpipe.set3learn,
simsRL_LTMpipe.set6learn,
simsRL_LTMpipe.s3s6test.temp[1:nrow(simsRL_LTMpipe$data), ],
simsRL_LTMpipe.s3s6test.temp[244 : 486, ],
simsRL_LTMpipe$data[,c('bll','alpha','egs','imag','ans')]) %>%
data.table()
#--------- Integrated model assigned strategy
simsRL_LTMstr <- fromJSON('./outdated_sim_data/RLLTM1_strategy_sim_data050420.JSON')
simsRL_LTMstr.set3learn <- simsRL_LTMstr$data$set3_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL_LTMstr$data)) %>%
t()
simsRL_LTMstr.set6learn <- simsRL_LTMstr$data$set6_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL_LTMstr$data)) %>%
t()
simsRL_LTMstr.s3s6test.temp <-
simsRL_LTMstr$data$set3_test %>%
cbind(., simsRL_LTMstr$data$set6_test) %>%
rep(., 12) %>%
as.matrix() %>%
reshape(., nrow(simsRL_LTMstr$data) * 12, 2) %>%
reshape(., nrow(simsRL_LTMstr$data) *2, 12)
RL_LTMstr.sim.dat <- cbind(simsRL_LTMstr.set3learn,
simsRL_LTMstr.set6learn,
simsRL_LTMstr.s3s6test.temp[1:nrow(simsRL_LTMstr$data), ],
simsRL_LTMstr.s3s6test.temp[973 : 1944, ],
simsRL_LTMstr$data[,c('bll','alpha','egs','imag','ans')]) %>%
data.table()
#--------- Reinforcement Learning Model
simsRL <- fromJSON('./outdated_sim_data/RL_sim_data_3lvsparams_050420.JSON')
simsRL.set3learn <- simsRL$data$set3_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL$data)) %>%
t()
simsRL.set6learn <- simsRL$data$set6_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsRL$data)) %>%
t()
simsRL.s3s6test.temp <-
simsRL$data$set3_test %>%
cbind(., simsRL$data$set6_test) %>%
rep(., 12) %>%
as.matrix() %>%
reshape(., nrow(simsRL$data)*12, 2) %>%
reshape(., nrow(simsRL$data)*2, 12)
RL.sim.dat <- cbind(simsRL.set3learn,
simsRL.set6learn,
simsRL.s3s6test.temp[1:nrow(simsRL$data), ],
simsRL.s3s6test.temp[10:18, ] ,
simsRL$data[,c('bll','alpha','egs','imag','ans')]) %>%
data.table()
#--------- Longterm Memory/WM/Declarative model
simsLTM    <- fromJSON('LTM_visual_activation_allparams_evals26.JSON')#('LTM_sim_data_3lvparams_050420.JSON')
simsLTM.set3learn <- simsLTM$data$set3_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsLTM$data)) %>%
t()
simsLTM.set6learn <- simsLTM$data$set6_learn %>%
unlist() %>%
as.matrix() %>%
reshape(., 12, nrow(simsLTM$data)) %>%
t()
simsLTM.s3s6test.temp <-  simsLTM$data$set3_test %>%
cbind(., simsLTM$data$set6_test) %>%
rep(., 12) %>%
as.matrix() %>%
reshape(., 324, 2) %>%
reshape(., 54, 12) #54= nrow(sims.LTM) * 2
LTM.sim.dat <- cbind(simsLTM.set3learn,
simsLTM.set6learn,
simsLTM.s3s6test.temp[1:27, ],
simsLTM.s3s6test.temp[28:54, ],
simsLTM$data[,c('bll','alpha','egs','imag','ans')]) %>%
data.table()
# LTM.sim.dat <- cbind('set3_learn'=simsLTM.set3learn %>% c(),
#                    'set6_learn'=simsLTM.set6learn %>% c(),
#                   'time'=rep(1:12,324/12),
#                  'set3_test'=simsLTM.s3s6test.temp[1:27, ] %>% c(),
#                 'set6_test'=simsLTM.s3s6test.temp[28:54, ] %>% c(),
#                simsLTM$data[,c('bll','alpha','egs','imag','ans')]) %>%
#data.table()
mseRL.temp         =c()
mseLTM.temp        =c()
mseRL_LTMorig.temp =c()
mseRL_LTMpipe.temp =c()
mseRL_LTMstr.temp  =c()
for(s in c(1:nrow(sdat.mod))) { # for each subject
# model 1
mseRL.temp     <- rbind(mseRL.temp, apply(RL.sim.dat[, 1:48], 1, function(x,y) MSE(x, sdat.mod[s, ])))
# model 2
mseLTM.temp    <- rbind(mseLTM.temp, apply(LTM.sim.dat[, 1:48], 1, function(x,y) MSE(x, sdat.mod[s, ] )))
# model 3
mseRL_LTMorig.temp <- rbind(mseRL_LTMorig.temp,
apply(RL_LTMorig.sim.dat[, 1:48], 1, function(x,y) MSE(x, sdat.mod[s, ])))
# model 3.1
mseRL_LTMpipe.temp <- rbind(mseRL_LTMpipe.temp,
apply(RL_LTMpipe.sim.dat[, 1:48], 1, function(x,y) MSE(x, sdat.mod[s, ])))
# model 3.2
mseRL_LTMstr.temp  <- rbind(mseRL_LTMstr.temp,
apply(RL_LTMstr.sim.dat[, 1:48], 1, function(x,y) MSE(x, sdat.mod[s, ])))
}
mseRL_LTMstr.temp
#------------first find the smalled mse
RL.fit     = as.matrix(apply(mseRL.temp, 1, min))     %>% sqrt()
LTM.fit    = as.matrix(apply(mseLTM.temp, 1, min))    %>% sqrt()
RL_LTMorig.fit = as.matrix(apply(mseRL_LTMorig.temp, 1, min)) %>% sqrt()
RL_LTMpipe.fit = as.matrix(apply(mseRL_LTMpipe.temp, 1, min)) %>% sqrt()
RL_LTMstr.fit = as.matrix(apply(mseRL_LTMstr.temp, 1, min)) %>% sqrt()
RL.fit
mseRL.temp
mseLTM.temp
mseRL_LTMorig.temp
mseRL_LTMorig.temp %>% View()
#temp <- mdat.3 %>%
#  data.table() %>%
#  .[,`:=`(V66 = V3 - mean(V3))]
#-------------second, find actual row number using smallest value
ind.temp.RL <- c()
ind.temp.RL_LTMorig <- c()
ind.temp.RL_LTMstr <- c()
ind.temp.RL_LTMpipe <- c()
ind.temp.LTM <- c()
for ( i in 1:length(RL.fit)) {
ind.temp.RL <- rbind(ind.temp.RL, which(mseRL.temp[i,] %in% RL.fit[i]))
}
for ( i in 1:length(LTM.fit)) {
ind.temp.LTM <- rbind(ind.temp.LTM, which(mseLTM.temp[i,] %in% LTM.fit[i]))
}
for ( i in 1:length(RL_LTMorig.fit)) {
ind.temp.RL_LTMorig <- rbind(ind.temp.RL_LTMorig,
which(mseRL_LTMorig.temp[i,] %in% RL_LTMorig.fit[i]))
}
for ( i in 1:length(RL_LTMpipe.fit)) {
ind.temp.RL_LTMpipe <- rbind(ind.temp.RL_LTMpipe,
which(mseRL_LTMpipe.temp[i,] %in% RL_LTMpipe.fit[i]))
}
for ( i in 1:length(RL_LTMstr.fit)) {
ind.temp.RL_LTMstr <- rbind(ind.temp.RL_LTMstr, which(mseRL_LTMstr.temp[i,] %in% RL_LTMstr.fit[i]))
}
ind.temp.RL_LTMstr
ind.temp.RL_LTMstr
ind.temp.RL
