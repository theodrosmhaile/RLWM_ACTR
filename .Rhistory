#geom_jitter(width=0, height = .02) +
# geom_smooth()+
geom_line()+
scale_color_brewer(palette = 'Set1') +
scale_x_discrete(labels=c('low','','','','','','','','','high'))+
xlab('parameter value') +
ylab('mean proportion of RL use')+
# geom_smooth(method = 'lm', alpha=.2)+
facet_wrap(vars(parameter)) +
theme_pubclean(base_size = 24)
###### Sort plots
simsRL_LTMpipe$data %>%
select( bll, ans, imag, egs,alpha) %>% #, egs,, alpha
scale(center=F) %>%
data.frame('strtg3'=simsRL_LTMpipe$data$strtg3,'strtg6'=simsRL_LTMpipe$data$strtg6) %>% #, 'strtg'=simsRL_LTMpipe$data$strtg
reshape2::melt(id.vars=c('strtg3','strtg6'), value.name = 'param_value', variable.name='parameter') %>% #,'strtg'
reshape2::melt(id.vars=c('parameter','param_value'), value.name='bias', variable.name='setsize' ) %>%
group_by(parameter,param_value, setsize) %>%
summarise('mean'=mean(bias), 'sem' = std(bias)/sqrt(n()) ) %>%
ggplot(aes(y=mean, x=factor(param_value),color=setsize, group=setsize)) +
geom_point() +
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem,width=.2, size=1.5 )) +
#geom_jitter(width=0, height = .02) +
# geom_smooth()+
geom_line(size=1.5 )+
scale_color_brewer(palette = 'Set1') +
scale_x_discrete(labels=c('low','','','','','','','','','high'))+
xlab('parameter value') +
ylab('mean proportion of RL use')+
# geom_smooth(method = 'lm', alpha=.2)+
facet_wrap(vars(parameter)) +
theme_pubclean(base_size = 24)
###### Sort plots
simsRL_LTMpipe$data %>%
select( bll, ans, imag, egs,alpha) %>% #, egs,, alpha
scale(center=F) %>%
data.frame('strtg3'=simsRL_LTMpipe$data$strtg3,'strtg6'=simsRL_LTMpipe$data$strtg6) %>% #, 'strtg'=simsRL_LTMpipe$data$strtg
reshape2::melt(id.vars=c('strtg3','strtg6'), value.name = 'param_value', variable.name='parameter') %>% #,'strtg'
reshape2::melt(id.vars=c('parameter','param_value'), value.name='bias', variable.name='setsize' ) %>%
group_by(parameter,param_value, setsize) %>%
summarise('mean'=mean(bias), 'sem' = std(bias)/sqrt(n()) ) %>%
ggplot(aes(y=mean, x=factor(param_value),color=setsize, group=setsize)) +
geom_point() +
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem,width=.8, size=1.2 )) +
#geom_jitter(width=0, height = .02) +
# geom_smooth()+
geom_line(size=1.2 )+
scale_color_brewer(palette = 'Set1') +
scale_x_discrete(labels=c('low','','','','','','','','','high'))+
xlab('parameter value') +
ylab('mean proportion of RL use')+
# geom_smooth(method = 'lm', alpha=.2)+
facet_wrap(vars(parameter)) +
theme_pubclean(base_size = 24)
###### Sort plots
simsRL_LTMpipe$data %>%
select( bll, ans, imag, egs,alpha) %>% #, egs,, alpha
scale(center=F) %>%
data.frame('strtg3'=simsRL_LTMpipe$data$strtg3,'strtg6'=simsRL_LTMpipe$data$strtg6) %>% #, 'strtg'=simsRL_LTMpipe$data$strtg
reshape2::melt(id.vars=c('strtg3','strtg6'), value.name = 'param_value', variable.name='parameter') %>% #,'strtg'
reshape2::melt(id.vars=c('parameter','param_value'), value.name='bias', variable.name='setsize' ) %>%
group_by(parameter,param_value, setsize) %>%
summarise('mean'=mean(bias), 'sem' = std(bias)/sqrt(n()) ) %>%
ggplot(aes(y=mean, x=factor(param_value),color=setsize, group=setsize)) +
geom_point() +
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem,width=.8, size=.5 )) +
#geom_jitter(width=0, height = .02) +
# geom_smooth()+
geom_line(size=1.2 )+
scale_color_brewer(palette = 'Set1') +
scale_x_discrete(labels=c('low','','','','','','','','','high'))+
xlab('parameter value') +
ylab('mean proportion of RL use')+
# geom_smooth(method = 'lm', alpha=.2)+
facet_wrap(vars(parameter)) +
theme_pubclean(base_size = 24)
###### Sort plots
simsRL_LTMpipe$data %>%
select( bll, ans, imag, egs,alpha) %>% #, egs,, alpha
scale(center=F) %>%
data.frame('strtg3'=simsRL_LTMpipe$data$strtg3,'strtg6'=simsRL_LTMpipe$data$strtg6) %>% #, 'strtg'=simsRL_LTMpipe$data$strtg
reshape2::melt(id.vars=c('strtg3','strtg6'), value.name = 'param_value', variable.name='parameter') %>% #,'strtg'
reshape2::melt(id.vars=c('parameter','param_value'), value.name='bias', variable.name='setsize' ) %>%
group_by(parameter,param_value, setsize) %>%
summarise('mean'=mean(bias), 'sem' = std(bias)/sqrt(n()) ) %>%
ggplot(aes(y=mean, x=factor(param_value),color=setsize, group=setsize)) +
geom_point() +
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem,width=.8 )) +
#geom_jitter(width=0, height = .02) +
# geom_smooth()+
geom_line(size=1.2 )+
scale_color_brewer(palette = 'Set1') +
scale_x_discrete(labels=c('low','','','','','','','','','high'))+
xlab('parameter value') +
ylab('mean proportion of RL use')+
# geom_smooth(method = 'lm', alpha=.2)+
facet_wrap(vars(parameter)) +
theme_pubclean(base_size = 24)
###### Sort plots
simsRL_LTMpipe$data %>%
select( bll, ans, imag, egs,alpha) %>% #, egs,, alpha
scale(center=F) %>%
data.frame('strtg3'=simsRL_LTMpipe$data$strtg3,'strtg6'=simsRL_LTMpipe$data$strtg6) %>% #, 'strtg'=simsRL_LTMpipe$data$strtg
reshape2::melt(id.vars=c('strtg3','strtg6'), value.name = 'param_value', variable.name='parameter') %>% #,'strtg'
reshape2::melt(id.vars=c('parameter','param_value'), value.name='bias', variable.name='setsize' ) %>%
group_by(parameter,param_value, setsize) %>%
summarise('mean'=mean(bias), 'sem' = std(bias)/sqrt(n()) ) %>%
ggplot(aes(y=mean, x=factor(param_value),color=setsize, group=setsize)) +
geom_point() +
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem,width=1,size=.4  )) +
#geom_jitter(width=0, height = .02) +
# geom_smooth()+
geom_line(size=1.2 )+
scale_color_brewer(palette = 'Set1') +
scale_x_discrete(labels=c('low','','','','','','','','','high'))+
xlab('parameter value') +
ylab('mean proportion of RL use')+
# geom_smooth(method = 'lm', alpha=.2)+
facet_wrap(vars(parameter)) +
theme_pubclean(base_size = 24)
###### Sort plots
simsRL_LTMpipe$data %>%
select( bll, ans, imag, egs,alpha) %>% #, egs,, alpha
scale(center=F) %>%
data.frame('strtg3'=simsRL_LTMpipe$data$strtg3,'strtg6'=simsRL_LTMpipe$data$strtg6) %>% #, 'strtg'=simsRL_LTMpipe$data$strtg
reshape2::melt(id.vars=c('strtg3','strtg6'), value.name = 'param_value', variable.name='parameter') %>% #,'strtg'
reshape2::melt(id.vars=c('parameter','param_value'), value.name='bias', variable.name='setsize' ) %>%
group_by(parameter,param_value, setsize) %>%
summarise('mean'=mean(bias), 'sem' = std(bias)/sqrt(n()) ) %>%
ggplot(aes(y=mean, x=factor(param_value),color=setsize, group=setsize)) +
geom_point() +
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem,width=1,size=.04  )) +
#geom_jitter(width=0, height = .02) +
# geom_smooth()+
geom_line(size=1.2 )+
scale_color_brewer(palette = 'Set1') +
scale_x_discrete(labels=c('low','','','','','','','','','high'))+
xlab('parameter value') +
ylab('mean proportion of RL use')+
# geom_smooth(method = 'lm', alpha=.2)+
facet_wrap(vars(parameter)) +
theme_pubclean(base_size = 24)
###### Sort plots
simsRL_LTMpipe$data %>%
select( bll, ans, imag, egs,alpha) %>% #, egs,, alpha
scale(center=F) %>%
data.frame('strtg3'=simsRL_LTMpipe$data$strtg3,'strtg6'=simsRL_LTMpipe$data$strtg6) %>% #, 'strtg'=simsRL_LTMpipe$data$strtg
reshape2::melt(id.vars=c('strtg3','strtg6'), value.name = 'param_value', variable.name='parameter') %>% #,'strtg'
reshape2::melt(id.vars=c('parameter','param_value'), value.name='bias', variable.name='setsize' ) %>%
group_by(parameter,param_value, setsize) %>%
summarise('mean'=mean(bias), 'sem' = std(bias)/sqrt(n()) ) %>%
ggplot(aes(y=mean, x=factor(param_value),color=setsize, group=setsize)) +
geom_point() +
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem),width=1,size=.04  )) +
#geom_jitter(width=0, height = .02) +
# geom_smooth()+
geom_line(size=1.2 )+
scale_color_brewer(palette = 'Set1') +
scale_x_discrete(labels=c('low','','','','','','','','','high'))+
xlab('parameter value') +
ylab('mean proportion of RL use')+
# geom_smooth(method = 'lm', alpha=.2)+
facet_wrap(vars(parameter)) +
theme_pubclean(base_size = 24)
###### Sort plots
simsRL_LTMpipe$data %>%
select( bll, ans, imag, egs,alpha) %>% #, egs,, alpha
scale(center=F) %>%
data.frame('strtg3'=simsRL_LTMpipe$data$strtg3,'strtg6'=simsRL_LTMpipe$data$strtg6) %>% #, 'strtg'=simsRL_LTMpipe$data$strtg
reshape2::melt(id.vars=c('strtg3','strtg6'), value.name = 'param_value', variable.name='parameter') %>% #,'strtg'
reshape2::melt(id.vars=c('parameter','param_value'), value.name='bias', variable.name='setsize' ) %>%
group_by(parameter,param_value, setsize) %>%
summarise('mean'=mean(bias), 'sem' = std(bias)/sqrt(n()) ) %>%
ggplot(aes(y=mean, x=factor(param_value),color=setsize, group=setsize)) +
geom_point() +
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem),width=1,size=.04) +
#geom_jitter(width=0, height = .02) +
# geom_smooth()+
geom_line(size=1.2 )+
scale_color_brewer(palette = 'Set1') +
scale_x_discrete(labels=c('low','','','','','','','','','high'))+
xlab('parameter value') +
ylab('mean proportion of RL use')+
# geom_smooth(method = 'lm', alpha=.2)+
facet_wrap(vars(parameter)) +
theme_pubclean(base_size = 24)
###### Sort plots
simsRL_LTMpipe$data %>%
select( bll, ans, imag, egs,alpha) %>% #, egs,, alpha
scale(center=F) %>%
data.frame('strtg3'=simsRL_LTMpipe$data$strtg3,'strtg6'=simsRL_LTMpipe$data$strtg6) %>% #, 'strtg'=simsRL_LTMpipe$data$strtg
reshape2::melt(id.vars=c('strtg3','strtg6'), value.name = 'param_value', variable.name='parameter') %>% #,'strtg'
reshape2::melt(id.vars=c('parameter','param_value'), value.name='bias', variable.name='setsize' ) %>%
group_by(parameter,param_value, setsize) %>%
summarise('mean'=mean(bias), 'sem' = std(bias)/sqrt(n()) ) %>%
ggplot(aes(y=mean, x=factor(param_value),color=setsize, group=setsize)) +
geom_point() +
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem),width=1.2, size=1.5) +
#geom_jitter(width=0, height = .02) +
# geom_smooth()+
geom_line(size=1.2 )+
scale_color_brewer(palette = 'Set1') +
scale_x_discrete(labels=c('low','','','','','','','','','high'))+
xlab('parameter value') +
ylab('mean proportion of RL use')+
# geom_smooth(method = 'lm', alpha=.2)+
facet_wrap(vars(parameter)) +
theme_pubclean(base_size = 24)
###### Sort plots
simsRL_LTMpipe$data %>%
select( bll, ans, imag, egs,alpha) %>% #, egs,, alpha
scale(center=F) %>%
data.frame('strtg3'=simsRL_LTMpipe$data$strtg3,'strtg6'=simsRL_LTMpipe$data$strtg6) %>% #, 'strtg'=simsRL_LTMpipe$data$strtg
reshape2::melt(id.vars=c('strtg3','strtg6'), value.name = 'param_value', variable.name='parameter') %>% #,'strtg'
reshape2::melt(id.vars=c('parameter','param_value'), value.name='bias', variable.name='setsize' ) %>%
group_by(parameter,param_value, setsize) %>%
summarise('mean'=mean(bias), 'sem' = std(bias)/sqrt(n()) ) %>%
ggplot(aes(y=mean, x=factor(param_value),color=setsize, group=setsize)) +
geom_point() +
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem),width=.8, size=1.5) +
#geom_jitter(width=0, height = .02) +
# geom_smooth()+
geom_line(size=1.2 )+
scale_color_brewer(palette = 'Set1') +
scale_x_discrete(labels=c('low','','','','','','','','','high'))+
xlab('parameter value') +
ylab('mean proportion of RL use')+
# geom_smooth(method = 'lm', alpha=.2)+
facet_wrap(vars(parameter)) +
theme_pubclean(base_size = 24)
###### Sort plots
simsRL_LTMpipe$data %>%
select( bll, ans, imag, egs,alpha) %>% #, egs,, alpha
scale(center=F) %>%
data.frame('strtg3'=simsRL_LTMpipe$data$strtg3,'strtg6'=simsRL_LTMpipe$data$strtg6) %>% #, 'strtg'=simsRL_LTMpipe$data$strtg
reshape2::melt(id.vars=c('strtg3','strtg6'), value.name = 'param_value', variable.name='parameter') %>% #,'strtg'
reshape2::melt(id.vars=c('parameter','param_value'), value.name='bias', variable.name='setsize' ) %>%
group_by(parameter,param_value, setsize) %>%
summarise('mean'=mean(bias), 'sem' = std(bias)/sqrt(n()) ) %>%
ggplot(aes(y=mean, x=factor(param_value),color=setsize, group=setsize)) +
geom_point() +
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem),width=.8, size=1.2) +
#geom_jitter(width=0, height = .02) +
# geom_smooth()+
geom_line(size=1.2 )+
scale_color_brewer(palette = 'Set1') +
scale_x_discrete(labels=c('low','','','','','','','','','high'))+
xlab('parameter value') +
ylab('mean proportion of RL use')+
# geom_smooth(method = 'lm', alpha=.2)+
facet_wrap(vars(parameter)) +
theme_pubclean(base_size = 24)
###### Sort plots
simsRL_LTMpipe$data %>%
select( bll, ans, imag, egs,alpha) %>% #, egs,, alpha
scale(center=F) %>%
data.frame('strtg3'=simsRL_LTMpipe$data$strtg3,'strtg6'=simsRL_LTMpipe$data$strtg6) %>% #, 'strtg'=simsRL_LTMpipe$data$strtg
reshape2::melt(id.vars=c('strtg3','strtg6'), value.name = 'param_value', variable.name='parameter') %>% #,'strtg'
reshape2::melt(id.vars=c('parameter','param_value'), value.name='bias', variable.name='setsize' ) %>%
group_by(parameter,param_value, setsize) %>%
summarise('mean'=mean(bias), 'sem' = std(bias)/sqrt(n()) ) %>%
ggplot(aes(y=mean, x=factor(param_value),color=setsize, group=setsize)) +
geom_point() +
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem),width=.8, size=1) +
#geom_jitter(width=0, height = .02) +
# geom_smooth()+
geom_line(size=1.2 )+
scale_color_brewer(palette = 'Set1') +
scale_x_discrete(labels=c('low','','','','','','','','','high'))+
xlab('parameter value') +
ylab('mean proportion of RL use')+
# geom_smooth(method = 'lm', alpha=.2)+
facet_wrap(vars(parameter)) +
theme_pubclean(base_size = 24)
sorted.bic.dat %>%  data.frame(ind=c(1:15775)) %>%
filter(ind<101) %>%
reshape2::melt(id.vars='ind') %>%
group_by(ind) %>% dplyr::summarise(mean=mean(value),
sem=sd(value)/sqrt(83)) %>%
ggplot(aes(y=mean, x=ind))+
#geom_ribbon(aes(ymin=mean-sem,ymax=mean+sem, fill='red', alpha=0.4))+
geom_errorbar(aes(ymin=mean-sem,ymax=mean+sem, color='red'))+
geom_point() +
ggtitle("mean BIC for subsequent models") +
theme_pubclean()
BIC.diff %>%
filter(ind2<11) %>%
group_by(ind2) %>%
dplyr::summarise('mean.diff'=mean(value),'sem'=sd(value)/sqrt(83)) %>%
ggplot(aes(x=factor(ind2), y=mean.diff)) +
geom_point() +
geom_errorbar(aes(ymax=mean.diff+sem, ymin=mean.diff-sem)) +
ylab("Mean differences of consecutive BIC values")+
xlab('Index of rank ordered Ma-Mb model BICs differences') +
geom_hline(yintercept = c(0,2,6,10), color='red') +
#  geom_label(y=c(2,5,10),x=c(8,8,8),label=c('weak', 'meaningful','strong') )+
theme_pubclean(base_size = 20)
BIC.diff %>%
filter(ind2<11) %>%
group_by(ind2) %>%
dplyr::summarise('mean.diff'=mean(value),'sem'=sd(value)/sqrt(83)) %>%
ggplot(aes(x=factor(ind2), y=mean.diff)) +
geom_point() +
geom_errorbar(aes(ymax=mean.diff+sem, ymin=mean.diff-sem)) +
ylab("Mean differences of consecutive BIC values")+
xlab('Index of rank ordered Ma-Mb model BICs differences') +
geom_hline(yintercept = c(0,2,6,10), color='red') +
ylim(c(0,6))+
#  geom_label(y=c(2,5,10),x=c(8,8,8),label=c('weak', 'meaningful','strong') )+
theme_pubclean(base_size = 20)
BIC.diff
sorted.bic.dat
BIC.diff %>%
filter(ind2<11)
BIC.diff %>%
filter(ind2<11) %>%
group_by(ind2)
sorted.bic.dat %>%  data.frame(ind=c(1:15775)) %>%
filter(ind<101) %>%
reshape2::melt(id.vars='ind') %>%
group_by(ind) %>% dplyr::summarise(mean=mean(value),
sem=sd(value)/sqrt(83)) %>%
ggplot(aes(y=mean, x=ind))+
#geom_ribbon(aes(ymin=mean-sem,ymax=mean+sem, fill='red', alpha=0.4))+
geom_errorbar(aes(ymin=mean-sem,ymax=mean+sem, color='red'))+
geom_point() +
ggtitle("mean BIC for subsequent models") +
theme_pubclean()
consist.check <- rbind(
RL.bic %>% t() %>% data.frame(mod='RL'),
LTM.bic %>% t() %>% data.frame(mod='LTM'),
RL_LTMpipe.bic %>% t() %>% data.frame(mod='metaRL'),
RL_LTMstr.bic %>% t() %>% data.frame(mod='biased')
)
consist.check
comp
n.to.diff.model
BIC.diff %>%
filter(ind2<11) %>%
group_by(ind2) %>%
dplyr::summarise('mean.diff'=mean(value),'sem'=sd(value)/sqrt(83))
BIC.diff %>% head
sorted.bic.dat
c(1:10)
c(1:10) %>% diff
c(1, 4,2, 5,3,4) %>% diff
BIC.diff %>%
filter(ind2<11) %>%
group_by(ind2) %>%
dplyr::summarise('mean.diff'=mean(value),'sem'=sd(value)/sqrt(83)) %>%
ggplot(aes(x=factor(ind2), y=mean.diff)) +
geom_point() +
geom_errorbar(aes(ymax=mean.diff+sem, ymin=mean.diff-sem)) +
ylab("Mean differences of consecutive BIC values")+
xlab('rank ordered Mb-Ma model BIC differences') +
geom_hline(yintercept = c(0,2,6,10), color='red') +
ylim(c(0,6))+
scale_x_discrete(labels=c("M2-M1","M3-M2", "M4-M3", "M5-M4", "M6-M5", "M7-M6", "M8-M7", "M9-M8", "M10-M9", "M11-M10"))+
#  geom_label(y=c(2,5,10),x=c(8,8,8),label=c('weak', 'meaningful','strong') )+
theme_pubclean(base_size = 20)
BIC.diff %>%
filter(ind2<11) %>%
group_by(ind2) %>%
dplyr::summarise('mean.diff'=mean(value),'sem'=sd(value)/sqrt(83)) %>%
ggplot(aes(x=factor(ind2), y=mean.diff)) +
geom_point() +
geom_errorbar(aes(ymax=mean.diff+sem, ymin=mean.diff-sem)) +
ylab("Mean differences of consecutive BIC values")+
xlab('ordered Mb-Ma model BIC differences') +
geom_hline(yintercept = c(0,2,6,10), color='red') +
ylim(c(0,6))+
scale_x_discrete(labels=c("M2-M1","M3-M2", "M4-M3", "M5-M4", "M6-M5", "M7-M6", "M8-M7", "M9-M8", "M10-M9", "M11-M10"))+
#  geom_label(y=c(2,5,10),x=c(8,8,8),label=c('weak', 'meaningful','strong') )+
theme_pubclean(base_size = 20)
#Figure showing end of learning and test
melted.p.behav.model %>%
filter(iteration <=12 & iteration>=8, type=='model') %>%
group_by(subjects, setSize) %>%
summarize(learn_mean=mean(accuracy)) %>%
inner_join( melted.p.behav.model %>% filter(iteration ==13, type=='behav') %>%
group_by(subjects, setSize) %>%
summarize(test=accuracy), by=c('subjects','setSize')) %>%
pivot_longer(cols = c(learn_mean, test), values_to = 'accuracy', names_to = 'condition') %>%
summarySE( measurevar = "accuracy", groupvars = c("setSize", "condition")) %>%
ggplot(aes( condition, accuracy, color=setSize, group=setSize)) +
geom_point(size=2) +
geom_line(size=1.5) +
geom_errorbar(aes(ymin=accuracy-se, ymax=accuracy+se), width=.2, size=1.5) +
# facet_wrap(vars(model)) +
scale_color_brewer(palette = "Set1" ) +
xlab('condition') +
ylab('Accuracy')+
ylim(c(0.7,1))+
#ggtitle('change from learn')+
labs(color='set-size')+
theme_pubr(legend=c('bottom' ), base_family = 'Times')+
scale_x_discrete(labels=c("end of learning","test"))+
theme_pubclean(base_size = 24)
#Figure showing end of learning and test
melted.p.behav.model %>%
filter(iteration <=12 & iteration>=8, type=='model') %>%
group_by(subjects, setSize) %>%
summarize(learn_mean=mean(accuracy)) %>%
inner_join( melted.p.behav.model %>% filter(iteration ==13, type=='behav') %>%
group_by(subjects, setSize) %>%
summarize(test=accuracy), by=c('subjects','setSize')) %>%
pivot_longer(cols = c(learn_mean, test), values_to = 'accuracy', names_to = 'condition') %>%
summarySE( measurevar = "accuracy", groupvars = c("setSize", "condition")) %>%
ggplot(aes( condition, accuracy, color=setSize, group=setSize)) +
geom_point(size=2) +
geom_line(size=1.5) +
geom_errorbar(aes(ymin=accuracy-se, ymax=accuracy+se), width=.2, size=1.5) +
# facet_wrap(vars(model)) +
scale_color_brewer(palette = "Set1" ) +
xlab('condition') +
ylab('Accuracy')+
ylim(c(0.7,1))+
ggtitle('Test Phase')+
labs(color='set-size')+
theme_pubr(legend=c('bottom' ), base_family = 'Times')+
scale_x_discrete(labels=c("end of learning","test"))+
theme_pubclean(base_size = 24)
subjects.only.plt
#Figure showing end of learning and test
test.phase.plt <- melted.p.behav.model %>%
filter(iteration <=12 & iteration>=8, type=='model') %>%
group_by(subjects, setSize) %>%
summarize(learn_mean=mean(accuracy)) %>%
inner_join( melted.p.behav.model %>% filter(iteration ==13, type=='behav') %>%
group_by(subjects, setSize) %>%
summarize(test=accuracy), by=c('subjects','setSize')) %>%
pivot_longer(cols = c(learn_mean, test), values_to = 'accuracy', names_to = 'condition') %>%
summarySE( measurevar = "accuracy", groupvars = c("setSize", "condition")) %>%
ggplot(aes( condition, accuracy, color=setSize, group=setSize)) +
geom_point(size=2) +
geom_line(size=1.5) +
geom_errorbar(aes(ymin=accuracy-se, ymax=accuracy+se), width=.2, size=1.5) +
# facet_wrap(vars(model)) +
scale_color_brewer(palette = "Set1" ) +
xlab('condition') +
ylab('Accuracy')+
ylim(c(0.7,1))+
ggtitle('Test Phase')+
labs(color='set-size')+
theme_pubr(legend=c('bottom' ), base_family = 'Times')+
scale_x_discrete(labels=c("end of learning","test"))+
theme_pubclean(base_size = 24)
ggarrange(subjects.only.plt,test.phase.plt)
ggarrange(subjects.only.plt,test.phase.plt, common.legend = T)
learnTestDiff
learnTestDiff  %>%
summarySE(measurevar = "test_learn", groupvars = c( "model", "cond.model"))
fit.lr
filter(estimate.type=='slope') %>%
group_by(setSize,type, model) %>%
dplyr::summarize('mean'= mean(estimate),
'se' = sd(estimate, na.rm = T) / sqrt(sum(!is.na(estimate))))
fit.lr %>%
filter(estimate.type=='slope') %>%
group_by(setSize,type, model) %>%
dplyr::summarize('mean'= mean(estimate),
'se' = sd(estimate, na.rm = T) / sqrt(sum(!is.na(estimate))))
fit.lr.plt
fit.lr %>%
dplyr::filter(type=='behav', estimate.type=='slope') %>%
select(setSize, estimate) %>%
group_by(setSize) %>% summarize(mean(estimate), median(estimate)) %>% kable(caption = 'mean and median of slope for behavioral data by set-size')
fit.lr %>%
dplyr::filter(type=='behav', estimate.type=='slope') %>%
select(setSize, estimate) %>%
group_by(setSize) %>% summarize(mean(estimate), median(estimate))
fit.lr %>%
ungroup() %>%
dplyr::filter(type=='behav', estimate.type=='slope') %>%
select(setSize, estimate) %>%
t.test(estimate ~ setSize, data = .)
fit.lr %>%
filter(estimate.type=='slope') %>%
group_by(setSize,type, model) %>%
dplyr::summarize('mean'= mean(estimate),
'se' = sd(estimate, na.rm = T) / sqrt(sum(!is.na(estimate))))
fit.lr %>%
ungroup() %>%
filter(estimate.type=='slope',model!='RL') %>%
select(estimate,model,setSize,type) %>%
#ggplot(aes(estimate, fill=setSize)) +
#geom_density(alpha=.4)
lm(estimate ~ type*model,data=.) %>% anova
melted.p.behav.model
melted.p.behav.model %>%  filter(model=='Biased') %>% select(bias)
melted.p.behav.model %>%  filter(model=='Biased', type=='behav') %>% select(bias)
melted.p.behav.model %>%  filter(model=='Biased', type=='behav', iteration=='12') %>% select(bias)
melted.p.behav.model %>%  filter(model=='Biased', type=='behav', iteration=='12') %>% select(bias) %>% mean
melted.p.behav.model %>%  filter(model=='Biased', type=='behav', iteration=='12') %>% select(bias) %>% as.numeric() %>% mean()
melted.p.behav.model %>%  filter(model=='Biased', type=='behav', iteration=='12') %>% select(bias) %>% summarise(mean(bias))
0.3636-1
melted.p.behav.model %>%  filter(model=='Biased', type=='behav', iteration=='12') %>% select(bias) %>% mutate('pref'= bias>.4)
melted.p.behav.model %>%  filter(model=='Biased', type=='behav', iteration=='12') %>% select(bias) %>% mutate('pref'= bias<=.4)
melted.p.behav.model %>%  filter(model=='Biased', type=='behav', iteration=='12') %>% select(bias) %>% mutate('pref'= bias<=.4) %>% summarize(mean(pref))
melted.p.behav.model %>% names
melted.p.behav.model %>% head()
melted.p.behav.model %>%  filter(model=='Biased', condition=='s3.12.behav') %>% select(bias) %>% mutate('pref'= bias<=.4)
melted.p.behav.model %>%  filter(model=='Biased', condition=='s3.12.behav') %>% select(bias) %>% mutate('pref'= bias<=.4) %>% summarize(mean(pref))
melted.p.behav.model %>%  filter(model=='Biased', condition=='s3.12.behav') %>% select(bias) %>% mutate('pref'= bias<=.4) %>% summarize(mean(bias))
melted.p.behav.model %>%  filter(model=='Biased', condition=='s3.12.behav') %>% select(bias) %>% mutate('pref'= bias<=.4) %>% summarize(mean(1-bias))
1-36
1-.36
melted.p.behav.model %>%  filter(model=='Biased', condition=='s3.13.behav') %>% select(bias) %>% mutate('pref'= bias<=.4) %>% summarize(mean(1-bias))
melted.p.behav.model %>%  filter(model=='Biased', condition=='s3.12.behav')
melted.p.behav.model %>%  filter(model=='Biased', condition=='s3.12.behav') %>% summarySE()
melted.p.behav.model %>%  filter(model=='Biased', condition=='s3.12.behav') %>% summarySE(measurevar = 'accuracy', groupvars = c('model','setSize','iteration', 'cond.model'))
melted.p.behav.model %>%  filter(model=='Biased', condition=='s3.12.behav') %>% summarySE(measurevar = 'bias', groupvars = c('model','setSize','iteration', 'cond.model'))
